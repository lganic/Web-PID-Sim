<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PID Simulator</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <link rel="stylesheet" href="css/styles.css">
</head>

<body>
  <header>
    <h1>PID Simulator</h1>
  </header>
  <div style="text-align: center !important;">
    <br>
    <a href="https://github.com/lganic/Web-PID-Sim/" target="_blank">
      <img src="https://img.shields.io/badge/Source Code Here-blue?style=social&logo=github" alt="GitHub link"
        style="width: 300px; height: auto;">
    </a>
  </div>
  <div class="wrap">
    <section class="card">
      <h2>Scene</h2>
      <canvas id="scene" width="1200" height="180"></canvas>
      <input type="range" id="zoomSlider" min="0.5" max="5" step="0.1" value="1">
      <div class="row" style="margin-top:10px">
        <div class="legend">Red = Target boat · Green = Current boat</div>
      </div>
      <div class="row" style="margin-top:8px">
        <div>δ (error): <span class="kv" id="deltaReadout">0.00</span></div>
        <div>pos: <span class="kv" id="posReadout">0.00</span></div>
        <div>target: <span class="kv" id="tgtReadout">0.00</span></div>
      </div>
    </section>

    <aside class="card">
      <h2>Controls</h2>
      <div class="controls">
        <div class="control">
          <label>Proportional (P) <span class="kv" id="Pval">15.00</span></label>
          <input id="P" type="range" min="0" max="100" step="0.1" value="15">
        </div>
        <div class="control">
          <label>Wind / Static Force <button id="zerowind" style="height:15px; padding: 0px 10px; font-size: 12px;">Zero</button><span class="kv" id="Wval">-100.00</span></label>
          <input id="W" type="range" min="-300" max="300" step="1" value="-100">
        </div>
        <div class="control">
          <label>Integral (I) <span class="kv" id="Ival">1.00</span></label>
          <input id="I" type="range" min="0" max="10" step="0.01" value="1">
        </div>
        <div class="control">
          <label>Target amplitude <span class="kv" id="Aval">80</span></label>
          <input id="A" type="range" min="0" max="150" step="1" value="80">
        </div>
        <div class="control">
          <label>Derivative (D) <span class="kv" id="Dval">300.00</span></label>
          <input id="D" type="range" min="0" max="1000" step="1" value="300">
        </div>
        <div class="control">
          <label>Target period (s) <span class="kv" id="Tval">10</span></label>
          <input id="T" type="range" min="2" max="30" step="0.5" value="10">
        </div>
      </div>
      <div class="btns">
        <button id="reset">Reset</button>
        <button id="pause">Pause</button>
        <button id="helpBtn">Help</button>
      </div>
    </aside>

    <section class="card" style="grid-column:1 / -1">
      <div class="charts">
        <canvas id="deltaChart" class="chart" width="100%" height="15vh"></canvas>
        <canvas id="posChart" class="chart" width="100%" height="15vh"></canvas>
      </div>
    </section>
  </div>

  <div id="helpModal" class="modal">
    <div class="modal-content">
      <span class="close" id="closeHelp">&times;</span>
      <h2>Help — PID Boat Simulator</h2>
      <p>This simulator demonstrates a PID controller attempting to track a moving target position (red boat) with a
        controlled system (green boat). The target follows a sine wave motion.</p>
      <ul>
        <li><b>Scene:</b> Shows target (red) and current (green) boats on water (blue line).</li>
        <li><b>P, I, D Sliders:</b> Adjust proportional, integral, and derivative gains of the controller.</li>
        <li><b>Wind:</b> Adds a constant force offset to the system.</li>
        <li><b>Zoom Slider:</b> On the right side of the scene, zoom in/out vertically.</li>
        <li><b>Charts:</b> Delta (error between target and current) and Position (target vs. current) over time. </li>
      </ul>
      <p>Experiment with the PID parameters to see how the system reacts! Try increasing P for faster response, D for
        damping, or I to correct steady-state error. Be careful: too high gains can cause instability.</p>
    </div>
  </div>

  <script src='js/base.js'></script>
</body>

</html>